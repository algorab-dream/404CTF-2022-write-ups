## Un simple oracle (1/2)

### Description

En se connectant au serveur, on reçoit le message suivant : 

```
Voici le message secret que je dois garder. Vous pouvez le voir, de toute façon vous ne pourrez rien en faire!
15781089629230001677166592777005932651766076786985055720582378303643932463877590376295248192459363096387616453778017637408734694237640464599982705425730887858529525530392754990709701599627679646773416565327512907386021626611060273746880318189399444235062557307378773109778196619736455709663081435582498524629782524759439866303055570816667810115433774769246832337502238146064670347947263355388726366424604536031245166019101094221978952036446001622419102847574974899138646336219658485502479237655893201880622912473274762202391647372537696595353612828871048894095013709440330494974705315924514537133711978613677138080591
J'en profite également pour noter quelques informations ici:
N = 25579828933767407803094537707335019554121982824364234161482906069462711538078938896594836597328725891311561711049494737081591778013101806454366133007301739411548681452851372627310289059093895467257555112450093779740154488998549415444689512071967245044012684291198143772352037157144070967293021080877134671972366435453402070374524382594231550419535786251128753243772999905459305821341247446341238735744822060763277148631237681028248093071479042514307606463109413211139260518667990582104791835593030534950312623861632654539356350478605522120641576049527654634788738055036377230057128469014615455309674101387448266646083
e = 65537

Ceci étant dit, passons à ce que vous vouliez me dire!
```

On a donc le flag, et la clé publique utilisée pour le chiffrer.
De plus, on peut parler avec le serveur. S'agissant certainement d'un oracle de déchiffrement, on peut essayer en chiffrant un entier et en le lui envoyant, ici 2 :

```
> 3231174145540996045626278176220310484602917361313269328329789062920029179903492230649186277657711034099341043841640324706164517658367256405510574775292509627798803742119488253120908867892222990928462023623265323125347785848917837986943834698516000670988963401584255519067253792342969029664208704753204943486553634600513661596602708957686037853614770325660892690620895125297662188840115354513965398437489636469537417118978722457759976417413061345043676375812559097828506649854373645651457771768924652180826532703191111235811654256094075246918992568990686725193867076766377442488999541598019741608836875606253107854977
Voici ma réponse:
2
```

Pas de doute, il s'agit bien d'un oracle de déchiffrement !

### Solution

Partant de là, en utilisant une propriété du chiffrement RSA comme quoi le produit des textes chiffrés est le texte chiffré du produit des messages (et vice versa), on peut retrouver le flag comme ceci :

```python
from pwn import *

conn = remote('challenge.404ctf.fr',32128)
conn.recvline()
cipher = int(conn.recvline().decode())

conn.recvline()
e = int(conn.recvline().decode().split(' ')[2])
conn.recvline()
conn.recvline()
conn.recvline()

# On déchiffre Enc(flag)*Enc(2), donc on déchiffre Enc(flag*2) !
cc = str(cipher*(2**e)).encode()
conn.sendline(cc)

conn.recvline()

tmodn = int(conn.recvline().decode())//2

tmodn_byte = tmodn.to_bytes((tmodn.bit_length() + 7) // 8, 'big')

print(tmodn_byte)
```

On obtient alors le flag : 404CTF{L3s_0r4cl3s_RSA_s0n7_si_fr4g1l35}.